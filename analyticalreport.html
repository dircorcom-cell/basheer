<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ (Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f1f5f9;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -2px rgba(0, 0, 0, 0.07);
            padding: 1.5rem;
            transition: all 0.3s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        .chart-container {
            position: relative;
            height: 350px;
            width: 100%;
        }
        .table-container {
            max-height: 500px;
            overflow-y: auto;
        }
        .table-container::-webkit-scrollbar { width: 8px; }
        .table-container::-webkit-scrollbar-track { background: #f8fafc; border-radius: 10px;}
        .table-container::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px;}
        .table-container::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .progress-bar-container {
            background-color: #e5e7eb;
            border-radius: 9999px;
            overflow: hidden;
            width: 100%;
            height: 1rem;
        }
        .progress-bar {
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s ease-in-out;
        }
        .kpi-card {
            border-right: 4px solid;
        }
        .tab-button {
            transition: all 0.2s ease-in-out;
            border-bottom: 3px solid transparent;
        }
        .tab-button.active {
            border-bottom-color: #2563eb;
            color: #1d4ed8;
        }
        .tab-pane {
            display: none;
        }
        .tab-pane.active {
            display: block;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="container mx-auto max-w-screen-2xl">
        <!-- Header -->
        <header class="mb-6 text-center">
            <h1 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-blue-600 to-teal-400 bg-clip-text text-transparent pb-2">
                Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ
            </h1>
            <p class="text-md md:text-lg text-gray-500 mt-2 font-semibold">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©: 16 Ù…Ø§Ø±Ø³ 2025 - 31 ÙŠÙˆÙ„ÙŠÙˆ 2025</p>
        </header>

        <!-- Summary Stats -->
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 mb-6">
            <div class="card text-center p-4"><h3 class="font-bold text-gray-700">Ø£ÙŠØ§Ù… Ø§Ù„ØªÙ‚Ø±ÙŠØ±</h3><p id="summary-days" class="text-2xl font-bold text-gray-800 mt-1">0</p></div>
            <div class="card text-center p-4"><h3 class="font-bold text-gray-700">Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h3><p id="summary-employees" class="text-2xl font-bold text-gray-800 mt-1">0</p></div>
            <div class="card text-center p-4"><h3 class="font-bold text-gray-700">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h3><p id="summary-projects" class="text-2xl font-bold text-gray-800 mt-1">0</p></div>
            <div class="card text-center p-4"><h3 class="font-bold text-gray-700">Ø§Ù„Ù…Ø¯Ù†</h3><p id="summary-cities" class="text-2xl font-bold text-gray-800 mt-1">0</p></div>
            <div class="card text-center p-4"><h3 class="font-bold text-gray-700">Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3><p id="summary-sources" class="text-2xl font-bold text-gray-800 mt-1">0</p></div>
        </div>

        <!-- Filters -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div class="card">
                <h2 class="text-xl font-bold mb-3 text-gray-700">ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆØ¸Ù</h2>
                <select id="salesperson-filter" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 bg-white"></select>
            </div>
            <div class="card">
                <h2 class="text-xl font-bold mb-3 text-gray-700">ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</h2>
                <select id="project-filter" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 bg-white"></select>
            </div>
        </div>
        
        <!-- Employee Analysis Card (Initially Hidden) -->
        <div id="employee-analysis-card" class="card mb-6" style="display: none;">
            <h2 class="text-2xl font-bold mb-4 text-blue-700">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ù„Ù„Ù…ÙˆØ¸Ù: <span id="analysis-employee-name"></span></h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="p-4 bg-green-50 rounded-lg border-r-4 border-green-500">
                    <h3 class="font-bold text-lg text-green-800 mb-2">âœ… Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©</h3>
                    <ul id="analysis-positive" class="list-disc list-inside space-y-1 text-green-700"></ul>
                </div>
                <div class="p-4 bg-red-50 rounded-lg border-r-4 border-red-500">
                    <h3 class="font-bold text-lg text-red-800 mb-2">âš ï¸ Ù†Ù‚Ø§Ø· ØªØ­ØªØ§Ø¬ Ù„ØªØ·ÙˆÙŠØ±</h3>
                    <ul id="analysis-negative" class="list-disc list-inside space-y-1 text-red-700"></ul>
                </div>
                <div class="p-4 bg-yellow-50 rounded-lg border-r-4 border-yellow-500">
                    <h3 class="font-bold text-lg text-yellow-800 mb-2">ğŸ’¡ Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ† ÙˆØ§Ù„ØªØ·ÙˆÙŠØ±</h3>
                    <ul id="analysis-plan" class="list-disc list-inside space-y-1 text-yellow-700"></ul>
                </div>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-6">
            <div class="card kpi-card border-blue-500">
                <h3 class="text-gray-500 font-semibold">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3>
                <p id="total-leads" class="text-4xl font-bold text-blue-600 mt-2">0</p>
            </div>
            <div class="card kpi-card border-green-500">
                <h3 class="text-gray-500 font-semibold">Ø¹Ù…Ù„Ø§Ø¡ ÙØ§Ø¦Ø²ÙˆÙ† (Won)</h3>
                <p id="won-leads" class="text-4xl font-bold text-green-600 mt-2">0</p>
            </div>
            <div class="card kpi-card border-amber-500">
                <h3 class="text-gray-500 font-semibold">Ø¹Ù…Ù„Ø§Ø¡ Ù‚ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</h3>
                <p id="ongoing-leads" class="text-4xl font-bold text-amber-600 mt-2">0</p>
            </div>
            <div class="card kpi-card border-red-500">
                <h3 class="text-gray-500 font-semibold">Ø¹Ù…Ù„Ø§Ø¡ Ø®Ø§Ø³Ø±ÙˆÙ†</h3>
                <p id="lost-leads" class="text-4xl font-bold text-red-600 mt-2">0</p>
            </div>
        </div>

        <!-- Main Dashboard Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="card lg:col-span-2">
                <h2 class="text-xl font-bold mb-4 text-gray-700">ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h2>
                <div class="table-container">
                    <table class="w-full text-sm text-left text-gray-500">
                        <thead class="text-xs text-gray-700 uppercase bg-gray-50 sticky top-0">
                            <tr>
                                <th scope="col" class="px-6 py-3">Ø§Ù„Ù…ÙˆØ¸Ù</th>
                                <th scope="col" class="px-6 py-3 w-1/3">Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</th>
                            </tr>
                        </thead>
                        <tbody id="employees-table-body"></tbody>
                    </table>
                </div>
            </div>
            <div class="card">
                <h2 class="text-xl font-bold mb-4 text-gray-700">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h2>
                <div class="table-container">
                    <table class="w-full text-sm text-left text-gray-500">
                        <thead class="text-xs text-gray-700 uppercase bg-gray-50 sticky top-0">
                            <tr>
                                <th scope="col" class="px-6 py-3">Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</th>
                                <th scope="col" class="px-6 py-3">Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</th>
                            </tr>
                        </thead>
                        <tbody id="projects-table-body"></tbody>
                    </table>
                </div>
            </div>
            <div class="card">
                <h2 class="text-xl font-bold mb-4 text-gray-700">ØªØ­Ù„ÙŠÙ„ Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h2>
                <div class="chart-container"><canvas id="sourcesChart"></canvas></div>
            </div>
            <div class="card">
                <h2 class="text-xl font-bold mb-4 text-gray-700">Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</h2>
                <div class="chart-container"><canvas id="geoChart"></canvas></div>
            </div>
            <div class="card">
                <h2 class="text-xl font-bold mb-4 text-gray-700">ØªØ­Ù„ÙŠÙ„ Ø§Ø³Ø¨Ø§Ø¨ Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„</h2>
                <div class="chart-container"><canvas id="lossReasonChart"></canvas></div>
            </div>
        </div>

        <!-- Strategic Recommendations Section -->
        <div id="strategic-recommendations-card" class="card mt-6">
            <div class="flex items-center border-b pb-3 mb-4">
                 <h2 class="text-2xl font-bold text-gray-800">ØªÙˆØµÙŠØ§Øª ÙˆÙ…Ø¤Ø´Ø±Ø§Øª Ø£Ø¯Ø§Ø¡ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©</h2>
            </div>
           
            <!-- Tabs Navigation -->
            <div class="flex border-b mb-4">
                <button data-target="tab-supervisor" class="tab-button active flex items-center p-4 font-semibold text-gray-600">
                    <svg class="w-6 h-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                    Ù…Ø´Ø±Ù ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
                </button>
                <button data-target="tab-manager" class="tab-button flex items-center p-4 font-semibold text-gray-600">
                    <svg class="w-6 h-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                    Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
                </button>
                <button data-target="tab-campaigns" class="tab-button flex items-center p-4 font-semibold text-gray-600">
                    <svg class="w-6 h-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-2.236 9.168-5.518"></path></svg>
                    Ø§Ø®ØµØ§Ø¦ÙŠ Ø§Ù„Ø­Ù…Ù„Ø§Øª
                </button>
                <button data-target="tab-crm" class="tab-button flex items-center p-4 font-semibold text-gray-600">
                    <svg class="w-6 h-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path></svg>
                    Ù…Ø´Ø±Ù CRM
                </button>
            </div>

            <!-- Tabs Content -->
            <div id="recommendations-content">
                <!-- Content will be injected here -->
            </div>
        </div>
    </div>

    <script>
        // --- DATA SIMULATION ENGINE ---
        const finalReport = {
            employees: [ { name: "Rahma Albarakati", clients: 2187 }, { name: "Hanadi Alabdulwahed", clients: 1842 }, { name: "Rozana Alharbi", clients: 1025 }, { name: "Haneen Aljehani", clients: 723 }, { name: "Fatima Al-Qahtani", clients: 315 }, { name: "Mohammed Alghamdi", clients: 287 }, { name: "Ahmed Almalki", clients: 198 }, { name: "Layla Harth", clients: 175 }, { name: "Sultan Alhattani", clients: 162 }, { name: "Khalid Alghamdi", clients: 158 }, { name: "Nora Alsulami", clients: 142 }, { name: "Ali Alzahrani", clients: 138 }, { name: "Maha Alotaibi", clients: 125 }, { name: "Yara Alharbi", clients: 118 }, { name: "Fahad Alqurashi", clients: 112 }, { name: "Lina Alghamdi", clients: 105 }, { name: "Omar Alsayed", clients: 98 }, { name: "Hessa Alali", clients: 92 }, { name: "Zayed Alotaibi", clients: 88 }, { name: "Reem Alshammari", clients: 85 }, { name: "Mosaad Alharbi", clients: 82 }, { name: "Abeer Alghamdi", clients: 78 }, { name: "Khalid Alzahrani", clients: 75 }, { name: "Amal Alotaibi", clients: 72 }, { name: "Sultan Alghamdi", clients: 68 }, { name: "Muneera Alharbi", clients: 65 }, { name: "Noura Alzahrani", clients: 62 }, { name: "Reda Menshawi", clients: 12 } ],
            projects: [ { name: "Ù…Ø³Ø§Ø¨ Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ…", clients: 3128 }, { name: "Ù…Ø´Ø±ÙˆØ¹ Ù…Ø³Ø§Ø¨", clients: 2015 }, { name: "Ø¯ÙŠØ§Ø± Ø§ÙÙŠÙ†ÙŠÙˆ", clients: 987 }, { name: "Ø±Ø¨ÙˆØ© Ø±Ø²ÙŠØ¯ÙŠÙ†Ø³", clients: 512 }, { name: "Ù…Ù„Ø­Ù‚ Ù…Ø³Ø§Ø¨", clients: 200 }, { name: "Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù†Ø®ÙŠÙ„", clients: 185 }, { name: "ÙˆØ§Ø­Ø© Ø§Ù„Ø±ÙŠØ§Ø¶", clients: 115 } ],
            sources: [ { name: "Ø³Ù†Ø§Ø¨ Ø´Ø§Øª", clients: 3128 }, { name: "ØªÙŠÙƒ ØªÙˆÙƒ", clients: 2562 }, { name: "Ù…ÙƒØ§Ù„Ù…Ø§Øª ÙˆØ§Ø±Ø¯Ø©", clients: 685 }, { name: "Ù…Ø¹Ø§Ø±Ù Ø´Ø®ØµÙŠØ©", clients: 342 }, { name: "ØªØ³ÙˆÙŠÙ‚ Ø®Ø§Ø±Ø¬ÙŠ", clients: 125 }, { name: "Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¬ÙˆØ¬Ù„", clients: 115 }, { name: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ", clients: 85 } ],
            geo: [ { region: "Ø¬Ø¯Ø©", clients: 2735 }, { region: "Ø§Ù„Ø±ÙŠØ§Ø¶", clients: 2187 }, { region: "Ø§Ù„Ø´Ø±Ù‚ÙŠØ©", clients: 987 }, { region: "Ø§Ù„Ø¬Ù†ÙˆØ¨", clients: 512 }, { region: "Ø§Ù„Ø´Ù…Ø§Ù„", clients: 342 }, { region: "Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©", clients: 158 }, { region: "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©", clients: 125 }, { region: "Ø§Ù„Ù‚ØµÙŠÙ…", clients: 98 } ],
            lossReasons: [ { reason: "Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹", count: 987 }, { reason: "Ø§Ù„Ù…ÙˆÙ‚Ø¹", count: 685 }, { reason: "Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©", count: 342 }, { reason: "Ø§Ù„ØªÙˆÙ‚ÙŠØª", count: 125 }, { reason: "Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„", count: 48 } ],
            statuses: ["On Going", "New", "Won", "Lost", "Unqualified", "Qualified"]
        };

        function createWeightedList(items, key) { const list = []; items.forEach(item => { for (let i = 0; i < item[key]; i++) { list.push(item.name || item.region || item.reason); } }); return list; }
        const employeeList = createWeightedList(finalReport.employees, 'clients');
        const projectList = createWeightedList(finalReport.projects, 'clients');
        const sourceList = createWeightedList(finalReport.sources, 'clients');
        const geoList = createWeightedList(finalReport.geo, 'clients');
        const lossReasonList = createWeightedList(finalReport.lossReasons, 'count');
        
        let rawData = [];
        function generateRawData() { const data = []; for (let i = 0; i < 6842; i++) { const status = finalReport.statuses[Math.floor(Math.random() * finalReport.statuses.length)]; let lossReason = null; if (status === 'Lost' || status === 'Unqualified') { lossReason = lossReasonList[Math.floor(Math.random() * lossReasonList.length)]; } data.push({ id: i, employee: employeeList[i], project: projectList[Math.floor(Math.random() * projectList.length)], source: sourceList[Math.floor(Math.random() * sourceList.length)], geo: geoList[Math.floor(Math.random() * geoList.length)], status: status, lossReason: lossReason }); } return data; }

        // --- GLOBAL STATE & CHARTS ---
        let charts = {};
        Chart.register(ChartDataLabels);

        // --- CHART CREATION ---
        const createOrUpdateChart = (chartId, type, labels, data, label, options = {}) => {
            const ctx = document.getElementById(chartId).getContext('2d');
            if (charts[chartId]) charts[chartId].destroy();
            
            const defaultOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    datalabels: {
                        formatter: (value, context) => {
                            const chartType = context.chart.config.type;
                            if (chartType === 'pie' || chartType === 'doughnut') {
                                const sum = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                if (sum === 0 || value === 0) return '';
                                return (value * 100 / sum).toFixed(0) + '%';
                            }
                            return value > 0 ? value.toLocaleString() : '';
                        },
                        color: (context) => (context.chart.config.type === 'pie' || context.chart.config.type === 'doughnut') ? '#fff' : '#334155',
                        anchor: (context) => (context.chart.config.type === 'pie' || context.chart.config.type === 'doughnut') ? 'center' : 'end',
                        align: (context) => (context.chart.config.type === 'pie' || context.chart.config.type === 'doughnut') ? 'center' : 'end',
                        offset: 4,
                        font: { weight: 'bold', family: 'Tajawal' }
                    }
                },
                scales: (type === 'bar' || type === 'line') ? {
                    x: { ticks: { font: { family: 'Tajawal' } }, grid: { display: false } },
                    y: { ticks: { font: { family: 'Tajawal' } }, grid: { display: true, color: '#e2e8f0' } }
                } : {},
                indexAxis: type === 'horizontalBar' ? 'y' : 'x',
            };

            const baseColors = ['#2563eb', '#16a34a', '#9333ea', '#f97316', '#e11d48', '#f59e0b', '#6366f1', '#db2777'];
            charts[chartId] = new Chart(ctx, {
                type: type === 'horizontalBar' ? 'bar' : type,
                data: {
                    labels: labels,
                    datasets: [{
                        label: label,
                        data: data,
                        backgroundColor: Array.from({length: labels.length}, (_, i) => baseColors[i % baseColors.length]),
                        borderRadius: 4,
                        borderWidth: 0,
                    }]
                },
                options: { ...defaultOptions, ...options }
            });
        };

        // --- UI RENDERING FUNCTIONS ---
        const renderTable = (tbodyId, data, max) => {
            const tableBody = document.getElementById(tbodyId);
            tableBody.innerHTML = '';
            data.forEach(([name, count]) => {
                const percentageOfMax = max > 0 ? (count / max) * 100 : 0;
                const row = ` <tr class="bg-white border-b hover:bg-gray-50"> <td class="px-6 py-4 font-bold text-gray-700">${name}</td> <td class="px-6 py-4"> <div class="flex items-center justify-between"> <span class="font-bold text-gray-800">${count.toLocaleString()}</span> </div> <div class="progress-bar-container mt-1"> <div class="progress-bar bg-blue-500" style="width: ${percentageOfMax}%;"></div> </div> </td> </tr> `;
                tableBody.innerHTML += row;
            });
        };

        const generateEmployeeAnalysis = (employeeName, employeeData) => {
            if (employeeData.length === 0) return { positive: [], negative: [], plan: [] };
            
            const countBy = (data, key) => data.reduce((acc, item) => { if(item[key]) { acc[item[key]] = (acc[item[key]] || 0) + 1; } return acc; }, {});
            const getTopItem = (counts) => Object.keys(counts).length > 0 ? Object.entries(counts).sort((a, b) => b[1] - a[1])[0][0] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯";

            const wonLeads = employeeData.filter(d => d.status === 'Won').length;
            const lostLeads = employeeData.filter(d => d.status === 'Lost' || d.status === 'Unqualified').length;
            const conversionRate = employeeData.length > 0 ? (wonLeads / employeeData.length) * 100 : 0;
            const lossRate = employeeData.length > 0 ? (lostLeads / employeeData.length) * 100 : 0;
            
            const topProject = getTopItem(countBy(employeeData, 'project'));
            const topSource = getTopItem(countBy(employeeData, 'source'));
            const topLossReason = getTopItem(countBy(employeeData.filter(d => d.lossReason), 'lossReason'));

            let positive = [
                `ÙŠÙØ¸Ù‡Ø± ÙØ¹Ø§Ù„ÙŠØ© Ø¹Ø§Ù„ÙŠØ© ÙÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù‚Ø§Ø¯Ù…ÙŠÙ† Ù…Ù† Ø­Ù…Ù„Ø§Øª <strong>${topSource}</strong>.`,
                `ÙŠÙØ¸Ù‡Ø± ÙƒÙØ§Ø¡Ø© ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ <strong>${employeeData.length}</strong> Ø¹Ù…ÙŠÙ„ØŒ Ù…Ø¹ ØªØ±ÙƒÙŠØ² ÙˆØ§Ø¶Ø­ ÙÙŠ <strong>${topProject}</strong>.`
            ];
            if (conversionRate > 15) {
                positive.push(`Ù…Ø¹Ø¯Ù„ ØªØ­ÙˆÙŠÙ„ Ù…Ù…ØªØ§Ø² ÙŠØ¨Ù„Øº <strong>${conversionRate.toFixed(1)}%</strong>ØŒ Ù…Ù…Ø§ ÙŠØ¹ÙƒØ³ Ù…Ù‡Ø§Ø±Ø§Øª Ø¬ÙŠØ¯Ø© ÙÙŠ Ø§Ù„Ø¥Ù‚Ù†Ø§Ø¹ ÙˆØ¥ØªÙ…Ø§Ù… Ø§Ù„ØµÙÙ‚Ø§Øª.`);
            }

            let negative = [];
            if (lossRate > 25) {
                negative.push(`Ù…Ø¹Ø¯Ù„ Ø®Ø³Ø§Ø±Ø© Ù…Ø±ØªÙØ¹ ÙŠØ¨Ù„Øº <strong>${lossRate.toFixed(1)}%</strong>ØŒ ÙˆØ£Ø¨Ø±Ø² Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ù‡ÙŠ "<strong>${topLossReason}</strong>".`);
            } else {
                 negative.push(`Ø£Ø¨Ø±Ø² Ø£Ø³Ø¨Ø§Ø¨ Ø®Ø³Ø§Ø±Ø© Ø§Ù„ØµÙÙ‚Ø§Øª Ù„Ø¯ÙŠÙ‡ Ù‡ÙŠ "<strong>${topLossReason}</strong>"ØŒ ÙˆÙ‡ÙŠ Ù†Ù‚Ø·Ø© ÙŠÙ…ÙƒÙ† ØªØ­Ø³ÙŠÙ†Ù‡Ø§.`);
            }
            negative.push(`ØªØ¸Ù‡Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ±ÙƒÙŠØ²Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¹Ù…Ù„Ø§Ø¡ <strong>${topSource}</strong>Ø› ÙŠÙÙ†ØµØ­ Ø¨ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø±ÙˆÙ†Ø© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù† Ø­Ù…Ù„Ø§Øª Ø£Ø®Ø±Ù‰ Ø¨Ù†ÙØ³ Ø§Ù„ÙƒÙØ§Ø¡Ø©.`);

            let plan = [
                `<strong>Ø®Ø·Ø© Ù‚ØµÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ù‰:</strong> Ø­Ø¶ÙˆØ± ØªØ¯Ø±ÙŠØ¨ Ù…ØªØ®ØµØµ ÙÙŠ <strong>Ù…Ù‡Ø§Ø±Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª</strong>ØŒ Ù…Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ø¹ØªØ±Ø§Ø¶ "<strong>${topLossReason}</strong>".`,
                `<strong>Ø®Ø·Ø© Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ø¯Ù‰:</strong> ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø±ÙˆÙ†Ø© ÙÙŠ <strong>Ù…Ù‡Ø§Ø±Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø¨ÙŠØ¹ÙŠ</strong> Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£Ù†Ù…Ø§Ø· Ø¹Ù…Ù„Ø§Ø¡ Ù…ØªÙ†ÙˆØ¹ÙŠÙ† Ù‚Ø§Ø¯Ù…ÙŠÙ† Ù…Ù† Ø­Ù…Ù„Ø§Øª Ù…Ø®ØªÙ„ÙØ©.`,
            ];
            if (conversionRate < 10) {
                 plan.push(`<strong>ØªÙˆØµÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ©:</strong> Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ÙÙŠ Ù…Ø¬Ø§Ù„ <strong>Ù…Ù‡Ø§Ø±Ø© Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØµÙÙ‚Ø©</strong>ØŒ ÙˆØªØ­Ø¯ÙŠØ¯Ø§Ù‹ "ÙÙ† Ù‚Ø±Ø§Ø¡Ø© Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø´Ø±Ø§Ø¡" Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù… Ø¥Ù„Ù‰ Ù‚Ø±Ø§Ø±Ø§Øª Ø´Ø±Ø§Ø¡ ÙØ¹Ù„ÙŠØ©.`);
            }

            return { positive, negative, plan };
        };

        // --- DASHBOARD UPDATE LOGIC ---
        const updateDashboard = () => {
            const employeeFilter = document.getElementById('salesperson-filter').value;
            const projectFilter = document.getElementById('project-filter').value;
            
            // Conditional visibility for strategic recommendations
            const strategicCard = document.getElementById('strategic-recommendations-card');
            if (employeeFilter !== 'all' || projectFilter !== 'all') {
                strategicCard.style.display = 'none';
            } else {
                strategicCard.style.display = 'block';
            }

            let filteredData = rawData;
            if (employeeFilter !== 'all') filteredData = filteredData.filter(d => d.employee === employeeFilter);
            if (projectFilter !== 'all') filteredData = filteredData.filter(d => d.project === projectFilter);
            document.getElementById('total-leads').textContent = filteredData.length.toLocaleString();
            document.getElementById('won-leads').textContent = filteredData.filter(d => d.status === 'Won').length.toLocaleString();
            document.getElementById('ongoing-leads').textContent = filteredData.filter(d => d.status === 'On Going').length.toLocaleString();
            document.getElementById('lost-leads').textContent = filteredData.filter(d => d.status === 'Lost' || d.status === 'Unqualified').length.toLocaleString();
            const countBy = (data, key) => data.reduce((acc, item) => { acc[item[key]] = (acc[item[key]] || 0) + 1; return acc; }, {});
            const employeeCounts = Object.entries(countBy(filteredData, 'employee')).sort((a, b) => b[1] - a[1]);
            const projectCounts = Object.entries(countBy(filteredData, 'project')).sort((a, b) => b[1] - a[1]);
            const maxEmployeeCount = employeeCounts.length > 0 ? employeeCounts[0][1] : 0;
            const maxProjectCount = projectCounts.length > 0 ? projectCounts[0][1] : 0;
            renderTable('employees-table-body', employeeCounts, maxEmployeeCount);
            renderTable('projects-table-body', projectCounts, maxProjectCount);
            
            const sourceCounts = Object.entries(countBy(filteredData, 'source')).sort((a, b) => b[1] - a[1]);
            createOrUpdateChart('sourcesChart', 'horizontalBar', sourceCounts.map(s => s[0]), sourceCounts.map(s => s[1]), 'Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡');
            
            const geoCounts = Object.entries(countBy(filteredData, 'geo')).sort((a, b) => b[1] - a[1]);
            createOrUpdateChart('geoChart', 'horizontalBar', geoCounts.map(g => g[0]), geoCounts.map(g => g[1]), 'Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ');
            
            const lossData = filteredData.filter(d => d.lossReason);
            const lossReasonCounts = Object.entries(countBy(lossData, 'lossReason')).sort((a, b) => b[1] - a[1]);
            createOrUpdateChart('lossReasonChart', 'horizontalBar', lossReasonCounts.map(l => l[0]), lossReasonCounts.map(l => l[1]), 'Ø§Ø³Ø¨Ø§Ø¨ Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„');
            
            const analysisCard = document.getElementById('employee-analysis-card');
            if (employeeFilter !== 'all') {
                document.getElementById('analysis-employee-name').textContent = employeeFilter;
                const analysis = generateEmployeeAnalysis(employeeFilter, filteredData);
                document.getElementById('analysis-positive').innerHTML = analysis.positive.map(item => `<li>${item}</li>`).join('');
                document.getElementById('analysis-negative').innerHTML = analysis.negative.map(item => `<li>${item}</li>`).join('');
                document.getElementById('analysis-plan').innerHTML = analysis.plan.map(item => `<li>${item}</li>`).join('');
                analysisCard.style.display = 'block';
            } else {
                analysisCard.style.display = 'none';
            }
        };
        
        // --- INITIALIZATION ---
        const initializeDashboard = () => {
            const startDate = new Date('2025-03-16');
            const endDate = new Date('2025-07-31');
            document.getElementById('summary-days').textContent = Math.ceil(Math.abs(endDate - startDate) / (1000 * 60 * 60 * 24));
            document.getElementById('summary-employees').textContent = finalReport.employees.length;
            document.getElementById('summary-projects').textContent = finalReport.projects.length;
            document.getElementById('summary-cities').textContent = finalReport.geo.length;
            document.getElementById('summary-sources').textContent = finalReport.sources.length;
            const employeeSelect = document.getElementById('salesperson-filter');
            const projectSelect = document.getElementById('project-filter');
            employeeSelect.innerHTML = '<option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</option>';
            finalReport.employees.forEach(emp => { employeeSelect.innerHTML += `<option value="${emp.name}">${emp.name}</option>`; });
            projectSelect.innerHTML = '<option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</option>';
            finalReport.projects.forEach(proj => { projectSelect.innerHTML += `<option value="${proj.name}">${proj.name}</option>`; });
            employeeSelect.onchange = updateDashboard;
            projectSelect.onchange = updateDashboard;
            
            initializeRecommendationsTabs();

            rawData = generateRawData();
            updateDashboard();
        };

        const initializeRecommendationsTabs = () => {
            const recommendationsData = [
                { id: 'tab-supervisor', title: "1. Ù„Ù…Ø´Ø±Ù ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª", focus: "Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„ÙØ±ÙŠÙ‚ØŒ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±ØŒ ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ù‚ØµÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ù‰.", kpis: [ "**Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„ÙØ±Ø¯ÙŠ:** Ù…ØªØ§Ø¨Ø¹Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø°ÙŠÙ† ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ù… ÙƒÙ„ Ù…ÙˆØ¸ÙØŒ ÙˆÙ…Ø¹Ø¯Ù„ ØªØ­ÙˆÙŠÙ„Ù‡ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„ÙØ§Ø¦Ø²ÙŠÙ† (Won).", "**Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ù…ØªÙƒØ±Ø±Ø©:** Ù…Ù„Ø§Ø­Ø¸Ø© Ø£ÙƒØ«Ø± Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø®Ø³Ø§Ø±Ø© ØªÙƒØ±Ø§Ø±Ø§Ù‹ Ù„Ø¯Ù‰ ÙƒÙ„ Ù…ÙˆØ¸Ù ÙˆÙ„Ø¯Ù‰ Ø§Ù„ÙØ±ÙŠÙ‚ ÙƒÙƒÙ„.", "**Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù…:** Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙŠÙ‚ÙˆÙ…ÙˆÙ† Ø¨ØªØ³Ø¬ÙŠÙ„ Ù†ØªØ§Ø¦Ø¬ ØªÙˆØ§ØµÙ„Ù‡Ù… Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø¯Ù‚Ø© ÙÙŠ Ù†Ø¸Ø§Ù… CRM." ], recommendations: [ "**Ø¬Ù„Ø³Ø§Øª ØªØ¯Ø±ÙŠØ¨ ÙØ±Ø¯ÙŠØ©:** Ø§Ø³ØªØ®Ø¯Ù… 'Ø¨Ø·Ø§Ù‚Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡' ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙƒØ£Ø³Ø§Ø³ Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙØ±Ø¯ÙŠØ© (One-on-One).", "**Ù†Ù‚Ù„ Ø§Ù„Ù…Ø¹Ø±ÙØ©:** Ø­Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø£Ø¯Ø§Ø¡Ù‹ ÙˆØ§Ø·Ù„Ø¨ Ù…Ù†Ù‡Ù… Ù…Ø´Ø§Ø±ÙƒØ© Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª Ù…Ø¹ Ø¨Ù‚ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚.", "**ÙˆØ±Ø´ Ø¹Ù…Ù„ Ù…Ø±ÙƒØ²Ø©:** Ø¥Ø°Ø§ Ù„Ø§Ø­Ø¸Øª Ø£Ù† 'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹' Ù‡ÙŠ Ø³Ø¨Ø¨ Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø£ÙˆÙ„ØŒ Ù‚Ù… Ø¨ØªÙ†Ø¸ÙŠÙ… ÙˆØ±Ø´Ø© Ø¹Ù…Ù„ Ø­ÙˆÙ„ 'Ù…Ù‡Ø§Ø±Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø§Ø¹ØªØ±Ø§Ø¶Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©'.", "**Ø¯Ø¹Ù… Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…ØªØ¹Ø«Ø±ÙŠÙ†:** Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø°ÙŠÙ† Ù„Ø¯ÙŠÙ‡Ù… Ù…Ø¹Ø¯Ù„Ø§Øª Ø®Ø³Ø§Ø±Ø© Ø¹Ø§Ù„ÙŠØ© ÙˆÙ‚Ø¯Ù… Ù„Ù‡Ù… Ø¯Ø¹Ù…Ø§Ù‹ Ø¥Ø¶Ø§ÙÙŠØ§Ù‹." ] },
                { id: 'tab-manager', title: "2. Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª", focus: "Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ù…Ø¨ÙŠØ¹Ø§ØªØŒ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ØŒ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³ÙˆÙ‚ØŒ ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø±Ø¨Ø¹ÙŠØ© ÙˆØ§Ù„Ø³Ù†ÙˆÙŠØ©.", kpis: [ "**Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹:** Ù…Ù‚Ø§Ø±Ù†Ø© Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆÙ†Ø³Ø¨ Ø§Ù„Ù†Ø¬Ø§Ø­ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ù…Ø®ØªÙ„ÙØ©.", "**Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ:** ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø£Ø¯Ø§Ø¡Ù‹ ÙˆØ§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ·ÙˆÙŠØ±.", "**ÙØ¹Ø§Ù„ÙŠØ© Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡:** ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ù…Ù† ÙƒÙ„ Ø­Ù…Ù„Ø© ØªØ³ÙˆÙŠÙ‚ÙŠØ©." ], recommendations: [ "**ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹:** Ù‚Ù… Ø¨ØªØ­Ù„ÙŠÙ„ Ø£Ø³Ø¨Ø§Ø¨ Ù†Ø¬Ø§Ø­ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ÙƒØ¨Ø±Ù‰ ÙˆÙ‚Ø±Ø± Ù…Ø§ Ø¥Ø°Ø§ ÙƒÙ†Øª Ø³ØªØ²ÙŠØ¯ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠÙ‡Ø§ Ø£Ù… Ø³ØªØ·Ø¨Ù‚ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§ØªÙ‡Ø§ Ø§Ù„Ù†Ø§Ø¬Ø­Ø© Ø¹Ù„Ù‰ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø£Ø®Ø±Ù‰.", "**Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©:** Ù‚Ø±Ø± Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠØ¬Ø¨ ØªØ¹Ø²ÙŠØ² Ø§Ù„ÙØ±Ù‚ ÙÙŠ Ø§Ù„Ù…Ø¯Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø£Ù… Ø¥Ø·Ù„Ø§Ù‚ Ø­Ù…Ù„Ø§Øª Ù…Ø±ÙƒØ²Ø© Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ø£Ù‚Ù„ Ø£Ø¯Ø§Ø¡Ù‹.", "**ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ©:** ØªØ¹Ø§ÙˆÙ† Ù…Ø¹ Ù‚Ø³Ù… Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ù„ØªØ­Ù„ÙŠÙ„ Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù‚Ø§Ø¯Ù…ÙŠÙ† Ù…Ù† ÙƒÙ„ Ù‚Ù†Ø§Ø©.", "**ØªØ·ÙˆÙŠØ± Ø§Ù„ÙØ±ÙŠÙ‚:** Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù…ØŒ ÙÙƒØ± ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ ÙØ±Ù‚ Ù…ØªØ®ØµØµØ© Ù„ÙƒÙ„ Ù…Ø´Ø±ÙˆØ¹ Ø£Ùˆ Ù…Ù†Ø·Ù‚Ø© Ø¬ØºØ±Ø§ÙÙŠØ©." ] },
                { id: 'tab-campaigns', title: "3. Ù„Ø£Ø®ØµØ§Ø¦ÙŠ Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©", focus: "ØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©ØŒ Ø²ÙŠØ§Ø¯Ø© Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙ…Ù„ÙŠÙ†ØŒ ØªØ­Ù‚ÙŠÙ‚ Ø£ÙØ¶Ù„ Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ÙØ§Ù‚ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠ (ROAS).", kpis: [ "**Ø­Ø¬Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù„ÙƒÙ„ Ù…ØµØ¯Ø±:** ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„ØªÙŠ ØªØ¬Ù„Ø¨ Ø£ÙƒØ¨Ø± Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡.", "**Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù„ÙƒÙ„ Ù…ØµØ¯Ø±:** ØªØ­Ù„ÙŠÙ„ Ø£ÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ø± ÙŠØ£ØªÙŠ Ù…Ù†Ù‡Ø§ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø°ÙŠÙ† ÙŠØªØ­ÙˆÙ„ÙˆÙ† Ø¥Ù„Ù‰ 'Won' Ø¨Ù†Ø³Ø¨Ø© Ø£Ø¹Ù„Ù‰.", "**ØªÙƒÙ„ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙ…Ù„ (CPL):** Ù…Ù‚Ø§Ø±Ù†Ø© ØªÙƒÙ„ÙØ© Ø¬Ù„Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ù† ÙƒÙ„ Ù‚Ù†Ø§Ø©." ], recommendations: [ "**ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø§Ø³ØªÙ‡Ø¯Ø§Ù:** Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØ­Ù„ÙŠÙ„ Ø¯ÙŠÙ…ÙˆØºØ±Ø§ÙÙŠØ© Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± Ø§Ù„Ù…ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ù†Ø§Ø¬Ø­Ø© ÙˆØ§Ø³ØªØ®Ø¯Ù…Ù‡Ø§ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø­Ù…Ù„Ø§Øª Ø£ÙƒØ«Ø± Ø¯Ù‚Ø©.", "**ØªØ®ØµÙŠØµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©:** Ù„ÙƒÙ„ Ù…Ø´Ø±ÙˆØ¹ØŒ Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ø¦Ù„ Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© ØªØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø£ÙƒØ«Ø± ÙØ¹Ø§Ù„ÙŠØ© Ù„Ù‡.", "**Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ¯Ø©:** Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ù…ØµØ¯Ø± Ù…Ø¹ÙŠÙ† Ù…Ø¹Ø¯Ù„ ØªØ­ÙˆÙŠÙ„ Ø¹Ø§Ù„ÙØŒ ÙÙƒØ± ÙÙŠ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠÙ‡ Ù„Ø¬Ù„Ø¨ Ø¹Ù…Ù„Ø§Ø¡ Ø£ÙƒØ«Ø± Ø¬Ø¯ÙŠØ©.", "**Ø§Ø®ØªØ¨Ø§Ø± Ù‚Ù†ÙˆØ§Øª Ø¬Ø¯ÙŠØ¯Ø©:** Ø®ØµØµ Ù…ÙŠØ²Ø§Ù†ÙŠØ© ØµØºÙŠØ±Ø© Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù†ØµØ§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù‚Ø¯ ØªÙƒÙˆÙ† Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø£Ù‚Ù„ Ø£Ø¯Ø§Ø¡Ù‹." ] },
                { id: 'tab-crm', title: "4. Ù„Ù…Ø´Ø±Ù CRM ÙˆÙ…Ø­Ù„Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", focus: "Ø¯Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ§ØªØŒ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ØŒ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠØ©.", kpis: [ "**Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ù†Ø³Ø¨Ø© Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù‡Ø§Ù…Ø© (Ù…Ø«Ù„ Ø³Ø¨Ø¨ Ø§Ù„Ø®Ø³Ø§Ø±Ø©) Ù…Ù† Ù‚Ø¨Ù„ ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª.", "**Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡:** Ù‚ÙŠØ§Ø³ Ù…ØªÙˆØ³Ø· Ø§Ù„ÙˆÙ‚Øª Ø¨ÙŠÙ† Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ£ÙˆÙ„ ØªÙˆØ§ØµÙ„ ÙŠØªÙ… Ù…Ø¹Ù‡.", "**ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡:** Ù…Ø±Ø§Ù‚Ø¨Ø© ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ø§Ù„ØªÙ‡ ÙˆÙØ¹Ø§Ù„ÙŠØªÙ‡." ], recommendations: [ "**Ø¶Ù…Ø§Ù† Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù„ÙˆØ­Ø§Øª Ù…ØªØ§Ø¨Ø¹Ø© Ø¯Ø§Ø®Ù„ Ù†Ø¸Ø§Ù… CRM Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¹Ù‚Ø¯ ØªØ¯Ø±ÙŠØ¨Ø§Øª Ø¯ÙˆØ±ÙŠØ© Ù„Ù„ÙØ±ÙŠÙ‚.", "**ØªØ­Ø³ÙŠÙ† Ù‚ÙˆØ§Ø¹Ø¯ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡:** Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø°ÙˆÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ø§Ù„ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø£Ø¯Ø§Ø¡Ù‹.", "**Ø£ØªÙ…ØªØ© Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©:** Ù‚Ù… Ø¨Ø¥Ø¹Ø¯Ø§Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ÙÙŠ CRM Ù„ØªØ°ÙƒÙŠØ± Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¨Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡.", "**ØªØ·ÙˆÙŠØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±:** Ø§Ø¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„ØªØ·ÙˆÙŠØ± ØªÙ‚Ø§Ø±ÙŠØ± Ø¬Ø¯ÙŠØ¯Ø© ØªØ¬ÙŠØ¨ Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„ØªÙ‡Ù… Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©." ] }
            ];

            const contentContainer = document.getElementById('recommendations-content');
            contentContainer.innerHTML = ''; // Clear existing content

            recommendationsData.forEach((item, index) => {
                const kpisHtml = item.kpis.map(kpi => `<li>${kpi.replace(/\*\*(.*?)\*\*/g, '<strong class="text-gray-800">$1</strong>')}</li>`).join('');
                const recommendationsHtml = item.recommendations.map(rec => `<li>${rec.replace(/\*\*(.*?)\*\*/g, '<strong class="text-gray-800">$1</strong>')}</li>`).join('');

                const tabPane = `
                    <div id="${item.id}" class="tab-pane p-4 ${index === 0 ? 'active' : ''}">
                        <div class="mb-6">
                            <h4 class="flex items-center font-bold text-lg text-gray-800 mb-2">
                                <span class="text-2xl ml-2">ğŸ¯</span> Ø§Ù„ØªØ±ÙƒÙŠØ²
                            </h4>
                            <p class="text-gray-600">${item.focus}</p>
                        </div>
                        <div class="mb-6">
                            <h4 class="flex items-center font-bold text-lg text-gray-800 mb-2">
                                <span class="text-2xl ml-2">ğŸ“Š</span> Ù…Ø¤Ø´Ø±Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©
                            </h4>
                            <ul class="list-disc list-inside space-y-2 text-gray-600">${kpisHtml}</ul>
                        </div>
                        <div>
                            <h4 class="flex items-center font-bold text-lg text-gray-800 mb-2">
                                <span class="text-2xl ml-2">ğŸ’¡</span> Ù†ØµØ§Ø¦Ø­ ÙˆØªÙˆØµÙŠØ§Øª
                            </h4>
                            <ul class="list-disc list-inside space-y-2 text-gray-600">${recommendationsHtml}</ul>
                        </div>
                    </div>
                `;
                contentContainer.innerHTML += tabPane;
            });

            const tabButtons = document.querySelectorAll('.tab-button');
            const tabPanes = document.querySelectorAll('.tab-pane');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    const targetId = button.dataset.target;
                    tabPanes.forEach(pane => {
                        if (pane.id === targetId) {
                            pane.classList.add('active');
                        } else {
                            pane.classList.remove('active');
                        }
                    });
                });
            });
        };

        document.addEventListener('DOMContentLoaded', initializeDashboard);

    </script>
</body>
</html>
