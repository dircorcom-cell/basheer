<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฎุชุจุฑ ูุฃุทุฑ ุงูุชุฎุทูุท ุงูุงุณุชุฑุงุชูุฌู</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Warm Neutrals (Stone/White/Gray) with Teal Accent -->
    <!-- Application Structure Plan: Scrolling SPA with clearly distinguished Reference Frameworks (with background shading for separation), a colored separator, and the enriched Lab at the end. The final version prioritizes visual clarity and information separation. -->
    <!-- Visualization & Content Choices: (1) Framework Titles: Enlarged (3xl) and bolded with Unicode icons for clarity. (2) VRIO Redesign: Retains the clear 2x2 grid card layout. (3) Visual Separation: Added distinct, light backgrounds for alternating framework cards to prevent visual merging. (4) Lab Enrichment: Includes Mission, Vision, Values, and Goals for a comprehensive report. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    
    <style>
        body {
            font-family: 'Cairo', sans-serif;
        }
        .section-card {
            @apply p-6 sm:p-8 rounded-xl shadow-lg mb-10 border border-gray-100 transition duration-300;
        }
        /* Alternating backgrounds for clear separation */
        #swot_ref, #soar_ref, #vrio_ref {
            background-color: #fcfcfc; /* Very light white */
        }
        #tows_ref, #pestel_ref {
            background-color: #f9fafb; /* Tailwind gray-50 */
        }

        .framework-title {
            @apply text-3xl sm:text-4xl font-extrabold text-teal-800 mb-6 border-b-2 pb-3 border-teal-100;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
            margin-top: 20px;
        }
        textarea::placeholder, input::placeholder {
            color: #9ca3af; /* Tailwind gray-400 */
        }
        
        /* VRIO Styles */
        .vrio-grid {
            @apply grid grid-cols-2 gap-4 text-center mt-4;
        }
        .vrio-item {
            @apply p-4 rounded-lg border-2 font-bold transition duration-300;
        }
        .vrio-val { @apply bg-teal-50 border-teal-400 text-teal-800; }
        .vrio-rar { @apply bg-purple-50 border-purple-400 text-purple-800; }
        .vrio-imit { @apply bg-pink-50 border-pink-400 text-pink-800; }
        .vrio-org { @apply bg-blue-50 border-blue-400 text-blue-800; }

        /* Styles for Print to PDF */
        @media print {
            body > header,
            #separatorSection,
            #labFormContainer {
                display: none !important;
            }
            body {
                background-color: white !important;
                color: black !important;
                padding: 0;
            }
            .section-card, #generatedReport {
                box-shadow: none !important;
                border: none !important;
                page-break-after: always;
            }
            .framework-title {
                color: #0d9488 !important; /* Tailwind teal-700 */
                border-color: #ccfbf1 !important; /* Tailwind teal-100 */
            }
            .chart-container {
                page-break-inside: avoid;
            }
            #generatedReport {
                display: block !important; 
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen">

    <header class="bg-white shadow-md print:hidden">
        <div class="max-w-4xl mx-auto px-4 py-6">
            <h1 class="text-3xl font-extrabold text-center text-teal-800">
                ุฃุทุฑ ูุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฎุทูุท
            </h1>
            <p class="text-center text-gray-500 mt-1">ุฏููู ูุชูุงูู ููุจุณุท ูุงุณุชูุดุงู ุฃุฏูุงุช ุงูุชุญููู ุงูุงุณุชุฑุงุชูุฌู ุงูุฑุฆูุณูุฉ.</p>
        </div>
    </header>

    <main id="content-container" class="max-w-4xl mx-auto p-4 sm:p-8">

        <!-- 1. ุงูุฃุทุฑ ุงููุฑุฌุนูุฉ (Reference Frameworks) -->

        <section class="section-card bg-white">
            <h2 class="framework-title text-teal-700 border-teal-200 text-3xl sm:text-3xl">๐ ุฏููู ุงูุชุฎุทูุท ุงูุงุณุชุฑุงุชูุฌู ุงููุฑุฌุนู</h2>
            <p class="text-gray-700 mb-4 text-lg">
                ูุฐุง ุงูุฏููู ูุตูู ูุชูุฏูู ุฃุณุงุณ ูุชูู ูู ุงูุฃุทุฑ ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุฎูุณุฉ ุงูุญูููุฉ. ูู ุจุงูุชูุฑูุฑ ูุงุณุชุนุฑุงุถ ุงูุฃุทุฑ ุจุงูุชูุตููุ ุซู ุงูุชูู ุฅูู **"ุงููุฎุชุจุฑ ุงูุนููู"** ูู ุงูุฃุณูู ูุชุทุจูู ูุฐู ุงููุนุฑูุฉ ุนูู ูุคุณุณุชู ูุชูููุฏ ุชูุฑูุฑ ุดุงูู.
            </p>
        </section>

        <!-- 1.1 ุชุญููู SWOT -->
        <section class="section-card" id="swot_ref">
            <h2 class="framework-title">๐งญ ุชุญููู SWOT</h2>
            <p class="text-gray-700 mb-6">
                **ุชุญููู SWOT** ูู ุฃุฏุงุฉ ุชูููู ุฃุณุงุณูุฉ ุชุญุฏุฏ ุงูุนูุงูู ุงูุฏุงุฎููุฉ (ุงูููุฉ ูุงูุถุนู) ูุงูุนูุงูู ุงูุฎุงุฑุฌูุฉ (ุงููุฑุต ูุงูุชูุฏูุฏุงุช) ุงูุชู ุชุคุซุฑ ุนูู ุงูููุธูุฉุ ูุชูููุฏ ุงูุทุฑูู ูุนูููุฉ ุตูุน ุงููุฑุงุฑ ุงูุงุณุชุฑุงุชูุฌู.
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-blue-50 border-t-4 border-blue-500 rounded-lg p-5 shadow-sm">
                    <h3 class="text-xl font-semibold text-blue-800 mb-3">ุงูุนูุงูู ุงูุฏุงุฎููุฉ</h3>
                    <div class="space-y-3">
                        <div class="bg-white p-3 rounded-md border border-blue-200">
                            <h4 class="font-bold text-blue-700">ุงูููุฉ (Strengths)</h4>
                            <p class="text-sm text-gray-600">ุงูููุงุฑุฏ ูุงููุฏุฑุงุช ุงูุฅูุฌุงุจูุฉ ุงูุชู ุชููุญ ุงูููุธูุฉ ููุฒุฉ.</p>
                        </div>
                        <div class="bg-white p-3 rounded-md border border-red-200">
                            <h4 class="font-bold text-red-700">ุงูุถุนู (Weaknesses)</h4>
                            <p class="text-sm text-gray-600">ุงูุฌูุงูุจ ุงูุชู ุชูุชูุฑ ุฅูููุง ุงูููุธูุฉ.</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-green-50 border-t-4 border-green-500 rounded-lg p-5 shadow-sm">
                    <h3 class="text-xl font-semibold text-green-800 mb-3">ุงูุนูุงูู ุงูุฎุงุฑุฌูุฉ</h3>
                    <div class="space-y-3">
                        <div class="bg-white p-3 rounded-md border border-green-200">
                            <h4 class="font-bold text-green-700">ุงููุฑุต (Opportunities)</h4>
                            <p class="text-sm text-gray-600">ุงูุงุชุฌุงูุงุช ุฃู ุงูุธุฑูู ุงูุฎุงุฑุฌูุฉ ุงูุชู ูููู ุงุณุชุบูุงููุง.</p>
                        </div>
                        <div class="bg-white p-3 rounded-md border border-yellow-200">
                            <h4 class="font-bold text-yellow-700">ุงูุชูุฏูุฏุงุช (Threats)</h4>
                            <p class="text-sm text-gray-600">ุงูุนูุงูู ุงูุฎุงุฑุฌูุฉ ุงูุชู ูุฏ ุชุณุจุจ ุถุฑุฑูุง ููููุธูุฉ.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 1.2 ูุตูููุฉ TOWS -->
        <section class="section-card" id="tows_ref">
            <h2 class="framework-title">๐ ูุตูููุฉ TOWS</h2>
            <p class="text-gray-700 mb-6">
                **ูุตูููุฉ TOWS** ุชุทููุฑ ูุชุญููู SWOTุ ุญูุซ ุชุฑุจุท ุจูู ุงูุนูุงูู ุงูุฃุฑุจุนุฉ ูุชูููุฏ ุฃุฑุจุนุฉ ุฃููุงุน ูุญุฏุฏุฉ ูู ุงูุงุณุชุฑุงุชูุฌูุงุช:
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-teal-50 border-t-4 border-teal-500 rounded-lg p-5 shadow-sm">
                    <h3 class="text-xl font-semibold text-teal-800 mb-3">ุงุณุชุฑุงุชูุฌูุงุช ุงูููุฉ ูุงูุงุณุชุบูุงู</h3>
                    <div class="space-y-3">
                        <div class="bg-white p-3 rounded-md border border-teal-200">
                            <h4 class="font-bold text-teal-700">SO (ุงูููุฉ - ุงููุฑุต)</h4>
                            <p class="text-sm text-gray-600">ุงุณุชุฑุงุชูุฌูุฉ ูุฌูููุฉ: ุงุณุชุฎุฏุงู ููุงุท ุงูููุฉ ูุงุณุชุบูุงู ุงููุฑุต.</p>
                        </div>
                        <div class="bg-white p-3 rounded-md border border-yellow-200">
                            <h4 class="font-bold text-yellow-700">ST (ุงูููุฉ - ุงูุชูุฏูุฏุงุช)</h4>
                            <p class="text-sm text-gray-600">ุงุณุชุฑุงุชูุฌูุฉ ุฏูุงุนูุฉ: ุงุณุชุฎุฏุงู ููุงุท ุงูููุฉ ูุชูููู ุงูุชูุฏูุฏุงุช.</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-orange-50 border-t-4 border-orange-500 rounded-lg p-5 shadow-sm">
                    <h3 class="text-xl font-semibold text-orange-800 mb-3">ุงุณุชุฑุงุชูุฌูุงุช ุงูุถุนู ูุงูุชุนููุถ</h3>
                    <div class="space-y-3">
                        <div class="bg-white p-3 rounded-md border border-orange-200">
                            <h4 class="font-bold text-orange-700">WO (ุงูุถุนู - ุงููุฑุต)</h4>
                            <p class="text-sm text-gray-600">ุงุณุชุฑุงุชูุฌูุฉ ุนูุงุฌูุฉ: ุงูุชุบูุจ ุนูู ููุงุท ุงูุถุนู ุจุงุณุชุบูุงู ุงููุฑุต.</p>
                        </div>
                        <div class="bg-white p-3 rounded-md border border-red-200">
                            <h4 class="font-bold text-red-700">WT (ุงูุถุนู - ุงูุชูุฏูุฏุงุช)</h4>
                            <p class="text-sm text-gray-600">ุงุณุชุฑุงุชูุฌูุฉ ุงูููุงุดูุฉ: ุชูููู ููุงุท ุงูุถุนู ูุชุฌูุจ ุงูุชูุฏูุฏุงุช.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 1.3 ุฅุทุงุฑ SOAR -->
        <section class="section-card" id="soar_ref">
            <h2 class="framework-title">๐ ุฅุทุงุฑ SOAR</h2>
            <p class="text-gray-700 mb-6">
                ูุฑูุฒ **ุฅุทุงุฑ SOAR** ุนูู ุงูุฌูุงูุจ ุงูุฅูุฌุงุจูุฉ ูุงูุชุทูุนูุฉ (ููุงุท ุงูููุฉุ ุงููุฑุตุ ุงูุทููุญุงุชุ ุงููุชุงุฆุฌ)ุ ููุง ูุญูู ุงูุชุฑููุฒ ูู ุงููุดุงูู ุฅูู ุงูุจูุงุก ุนูู ุงููุฌุงุญุงุช.
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-purple-50 border-t-4 border-purple-500 rounded-lg p-5 shadow-sm">
                    <h3 class="text-xl font-semibold text-purple-800 mb-3">ุงูุชุญููู ุงูุญุงูู</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>**ููุงุท ุงูููุฉ (Strengths):** ูุง ุชูุนูู ุงูููุธูุฉ ุจุดูู ููุชุงุฒ.</li>
                        <li>**ุงููุฑุต (Opportunities):** ุงููุฌุงูุงุช ุงูุฎุงุฑุฌูุฉ ุงููุชุงุญุฉ ููููู.</li>
                    </ul>
                </div>
                
                <div class="bg-pink-50 border-t-4 border-pink-500 rounded-lg p-5 shadow-sm">
                    <h3 class="text-xl font-semibold text-pink-800 mb-3">ุงูุชุทูุน ุงููุณุชูุจูู</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>**ุงูุทููุญุงุช (Aspirations):** ุงูุฑุคูุฉ ุงููุดุชุฑูุฉ ููุง ุชุฑูุฏ ุงูููุธูุฉ ุชุญูููู.</li>
                        <li>**ุงููุชุงุฆุฌ (Results):** ูุคุดุฑุงุช ูุงุจูุฉ ููููุงุณ ูุชุชุจุน ุงูุชูุฏู.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- 1.4 ุชุญููู PESTEL -->
        <section class="section-card" id="pestel_ref">
            <h2 class="framework-title">๐ ุชุญููู PESTEL</h2>
            <p class="text-gray-700 mb-6">
                **ุชุญููู PESTEL** ููุณุชุฎุฏู ููุณุญ ูุชุญููู ุงูุนูุงูู ุงูุฎุงุฑุฌูุฉ ุงููุจุฑู (ุงูุจูุฆุฉ ุงููููุฉ) ุงูุชู ูุฌุจ ุนูู ุงูููุธูุฉ ุฃู ุชุชููู ูุนูุง.
            </p>

            <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 mb-8">
                <div class="bg-gray-100 p-3 rounded-lg text-center border border-gray-200">
                    <span class="font-bold text-teal-700">P</span>: ุงูุณูุงุณูุฉ
                </div>
                <div class="bg-gray-100 p-3 rounded-lg text-center border border-gray-200">
                    <span class="font-bold text-teal-700">E</span>: ุงูุงูุชุตุงุฏูุฉ
                </div>
                <div class="bg-gray-100 p-3 rounded-lg text-center border border-gray-200">
                    <span class="font-bold text-teal-700">S</span>: ุงูุงุฌุชูุงุนูุฉ
                </div>
                <div class="bg-gray-100 p-3 rounded-lg text-center border border-gray-200">
                    <span class="font-bold text-teal-700">T</span>: ุงูุชูููููุฌูุฉ
                </div>
                <div class="bg-gray-100 p-3 rounded-lg text-center border border-gray-200">
                    <span class="font-bold text-teal-700">E</span>: ุงูุจูุฆูุฉ
                </div>
                <div class="bg-gray-100 p-3 rounded-lg text-center border border-gray-200">
                    <span class="font-bold text-teal-700">L</span>: ุงููุงููููุฉ
                </div>
            </div>
        </section>

        <!-- 1.5 ุฅุทุงุฑ VRIO (ุชู ุฅุนุงุฏุฉ ุงูุชุตููู) -->
        <section class="section-card" id="vrio_ref">
            <h2 class="framework-title">๐ ุฅุทุงุฑ VRIO</h2>
            <p class="text-gray-700 mb-6">
                ููุณุชุฎุฏู **ุฅุทุงุฑ VRIO** ูุชูููู ุงูููุงุฑุฏ ูุงููุฏุฑุงุช ุงูุฏุงุฎููุฉ ููููุธูุฉ ูุชุญุฏูุฏ ุงููุฒุงูุง ุงูุชูุงูุณูุฉ ุงููุณุชุฏุงูุฉ.
            </p>

            <h3 class="text-xl font-semibold text-gray-800 mt-6 mb-4">ูุนุงููุฑ ุชูููู ุงูููุฒุฉ ุงูุชูุงูุณูุฉ</h3>
            <div class="vrio-grid">
                <div class="vrio-item vrio-val shadow-lg">
                    <div class="text-3xl mb-1">โ</div>
                    ุงููููุฉ (Value)
                </div>
                <div class="vrio-item vrio-rar shadow-lg">
                    <div class="text-3xl mb-1">โญ</div>
                    ุงููุฏุฑุฉ (Rarity)
                </div>
                <div class="vrio-item vrio-imit shadow-lg">
                    <div class="text-3xl mb-1">๐ก๏ธ</div>
                    ุนุฏู ุงููุงุจููุฉ ููุชูููุฏ (Imitability)
                </div>
                <div class="vrio-item vrio-org shadow-lg">
                    <div class="text-3xl mb-1">โ๏ธ</div>
                    ุงูุชูุธูู (Organization)
                </div>
            </div>
            <p class="text-sm text-gray-600 mt-4 text-center">
                ูุฌุจ ุฃู ูุฌุชุงุฒ ุงูููุฑุฏ ุฌููุน ูุฐู ุงูุงุฎุชุจุงุฑุงุช ููุญุตูู ุนูู ููุฒุฉ ุชูุงูุณูุฉ ูุณุชุฏุงูุฉ.
            </p>
        </section>

        <!-- ูุงุตู ูููู ุจูู ุงููุนุฑูุฉ ูุงูุชุทุจูู -->
        <section id="separatorSection" class="bg-teal-100 py-10 px-6 rounded-xl text-center shadow-inner my-12 print:hidden border-4 border-teal-400 border-dashed">
            <h3 class="text-3xl font-extrabold text-teal-800">๐๏ธ ุงููุฎุชุจุฑ ุงูุนููู: ุจูุงุก ุงูุชูุฑูุฑ ุงููุชูุงูู</h3>
            <p class="text-teal-700 mt-2 text-lg font-semibold">ุงููุฃ ุจูุงูุงุช ุงููููุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ ูููุคุณุณุฉ ุฃููุงูุ ุซู ุฃููู ุงูุชุญููู ูุชูููุฏ ุชูุฑูุฑ ุงุญุชุฑุงูู.</p>
        </section>

        <!-- 2. ุงูุชูุฑูุฑ ุงูุดุงูู ุงููุงุชุฌ (ูุฎูู ูุจุฏุฆูุงู) -->
        <section class="section-card hidden" id="generatedReport">
            <h2 class="framework-title text-3xl text-teal-700 border-teal-200">๐ ุงูุชูุฑูุฑ ุงูุงุณุชุฑุงุชูุฌู ุงูุดุงูู ุงููุงุชุฌ</h2>
            
            <div id="reportHeader" class="text-center mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
                <h3 class="text-2xl font-bold" id="reportEntityName"></h3>
                <p class="text-lg text-gray-600" id="reportDate"></p>
            </div>
            
            <!-- ุฒุฑ ุงูุทุจุงุนุฉ -->
            <button id="printBtn" onclick="window.print()" class="w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 transition duration-300 shadow-md mb-8 print:hidden">
                ๐จ๏ธ ุทุจุงุนุฉ ุงูุชูุฑูุฑ ูููู PDF
            </button>
            
            <!-- ุงููููุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ -->
            <div class="mb-8 p-5 bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="text-xl font-bold text-teal-600 mb-3 border-b pb-2">ุงููููุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ ูุงูุฃูุฏุงู</h3>
                <p class="mb-2 text-gray-700"><strong>ุงูุฑุคูุฉ:</strong> <span class="font-semibold text-purple-700" id="r_vision"></span></p>
                <p class="mb-2 text-gray-700"><strong>ุงูุฑุณุงูุฉ:</strong> <span class="font-semibold text-blue-700" id="r_mission"></span></p>
                <p class="mb-2 text-gray-700"><strong>ุงูููู ุงูุฑุฆูุณูุฉ:</strong> <span class="font-semibold text-pink-700" id="r_values"></span></p>
                <p class="mb-2 text-gray-700"><strong>ุงูุฃูุฏุงู ุงูุงุณุชุฑุงุชูุฌูุฉ:</strong> <span class="font-semibold text-teal-700" id="r_goals"></span></p>
            </div>

            <!-- ูุชุงุฆุฌ SWOT -->
            <div class="mb-8 p-5 bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="text-xl font-bold text-teal-600 mb-3 border-b pb-2">ุชุญููู SWOT ุงูุชูุตููู</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div class="p-3 bg-blue-50 rounded-md"><strong>ููุงุท ุงูููุฉ (S):</strong> <ul class="list-disc list-inside mt-1" id="r_strength"></ul></div>
                    <div class="p-3 bg-red-50 rounded-md"><strong>ููุงุท ุงูุถุนู (W):</strong> <ul class="list-disc list-inside mt-1" id="r_weakness"></ul></div>
                    <div class="p-3 bg-green-50 rounded-md"><strong>ุงููุฑุต (O):</strong> <ul class="list-disc list-inside mt-1" id="r_opportunity"></ul></div>
                    <div class="p-3 bg-yellow-50 rounded-md"><strong>ุงูุชูุฏูุฏุงุช (T):</strong> <ul class="list-disc list-inside mt-1" id="r_threat"></ul></div>
                </div>
            </div>

            <!-- ูุชุงุฆุฌ TOWS -->
            <div class="mb-8 p-5 bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="text-xl font-bold text-teal-600 mb-3 border-b pb-2">ุงุณุชุฑุงุชูุฌูุงุช TOWS ุงููุงุชุฌุฉ (ููุชุฑุญุฉ)</h3>
                <div class="space-y-3 text-sm">
                    <p class="p-3 bg-green-100 rounded-md border border-green-200"><strong>SO (ุงุณุชุบูุงู ูุฌููู):</strong> <span id="r_so"></span></p>
                    <p class="p-3 bg-orange-100 rounded-md border border-orange-200"><strong>WO (ุชุญูู ุนูุงุฌู):</strong> <span id="r_wo"></span></p>
                    <p class="p-3 bg-blue-100 rounded-md border border-blue-200"><strong>ST (ุชุญุตูู ุฏูุงุนู):</strong> <span id="r_st"></span></p>
                    <p class="p-3 bg-red-100 rounded-md border border-red-200"><strong>WT (ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ):</strong> <span id="r_wt"></span></p>
                </div>
            </div>
            
            <!-- ูุชุงุฆุฌ SOAR -->
            <div class="mb-8 p-5 bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="text-xl font-bold text-teal-600 mb-3 border-b pb-2">ุฎูุงุตุฉ SOAR (ุชุญููู ุงูุฑุคูุฉ)</h3>
                <p class="text-gray-700 mb-2">
                    ุงูุทููุญ ุงููุชูุซู ูู: **<span class="font-bold text-purple-700" id="r_aspiration_text"></span>** ูุณุงูู ูุจุงุดุฑุฉ ูู ุชุญููู **ุงูุฑุคูุฉ: <span class="font-bold text-blue-700" id="r_soar_vision"></span>**. ูุชู ุงูุงุนุชูุงุฏ ุนูู **ุงูููุฉ:** <span class="font-semibold text-blue-700" id="r_soar_strength"></span>ุ ูููุงุณ ุงููุฌุงุญ ูุชู ุนุจุฑ **ุงููุคุดุฑ:** <span class="font-semibold text-pink-700" id="r_soar_kpi"></span>.
                </p>
            </div>

            <!-- ูุชุงุฆุฌ VRIO -->
            <div class="mb-8 p-5 bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="text-xl font-bold text-teal-600 mb-3 border-b pb-2">ุชุญููู VRIO ูุชูููู ุงููุฒุงูุง ุงูุชูุงูุณูุฉ</h3>
                <p class="text-gray-700 mb-2">
                    ุชู ุชูููู ุงูููุฑุฏ ุงููุญุฏุฏ: **<span class="font-bold text-teal-700" id="vrio_resource"></span>** ููุชุฃูุฏ ูู ุชูุงููู ูุน ููู ุงููุคุณุณุฉ (ุงูููู: <span class="font-semibold text-pink-700" id="r_vrio_values"></span>):
                </p>
                <div id="r_vrio_conclusion" class="p-4 rounded-lg font-semibold"></div>
            </div>

            <!-- ูุชุงุฆุฌ PESTEL -->
            <div class="mb-8 p-5 bg-white border border-gray-200 rounded-lg shadow-sm">
                <h3 class="text-xl font-bold text-teal-600 mb-3 border-b pb-2">ุชุญููู PESTEL (ุงูุนูุงูู ุงูุฎุงุฑุฌูุฉ ุงููููุฉ)</h3>
                <p class="text-gray-700 mb-4">
                    ุชู ุชูููู ุงูุนูุงูู ุงูุฎุงุฑุฌูุฉ ุงูุณุชุฉ ุจูุงุกู ุนูู ูุทุงุน **<span class="font-bold text-teal-700" id="r_industry"></span>**ุ ุญูุซ ุชูุซู ุงูููุงุท ุงููุฑุชูุนุฉ ุชุฃุซูุฑูุง ุฃู ุงูุชูุงููุง ูุจูุฑูุง:
                </p>
                <div class="chart-container">
                    <canvas id="reportPestelChart"></canvas>
                </div>
            </div>
            
        </section>


        <!-- 3. ุงููุฎุชุจุฑ ุงูุนููู (FORM - ูู ุงูุฃุณูู) -->
        <section class="section-card" id="labFormContainer">
            <h2 class="framework-title text-blue-700 border-blue-100">๐ ุงููุฎุชุจุฑ ุงูุนููู: ุฃุฏุฎู ุจูุงูุงุช ูุคุณุณุชู</h2>
            <p class="text-gray-700 mb-6 font-semibold">
                ุงููุฃ ุงูุญููู ุงูุชุงููุฉ ุจุฃูุจุฑ ูุฏุฑ ูููู ูู ุงูุชูุตูู ููุญุตูู ุนูู ุชูุฑูุฑ ุงุณุชุฑุงุชูุฌู ููู ูููุตู.
            </p>
            
            <form id="strategicLabForm" class="space-y-6">
                
                <!-- ุงููููุฉ ุงูุฃุณุงุณูุฉ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="entityName" class="block text-sm font-medium text-gray-700">ุงุณู ุงูุฌูุฉ / ุงููุคุณุณุฉ</label>
                        <input type="text" id="entityName" placeholder="ูุซุงู: ุดุฑูุฉ ุงููุณุชูุจู ุงูุฑููู" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border" required>
                    </div>
                    <div>
                        <label for="entityIndustry" class="block text-sm font-medium text-gray-700">ุงููุทุงุน / ุงูุชุฑููุฒ ุงูุฑุฆูุณู</label>
                        <select id="entityIndustry" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border bg-white" required>
                            <option value="Technology">ุงูุชูููุฉ ูุงูุงุจุชูุงุฑ</option>
                            <option value="Charity">ุงูุฌูุนูุงุช ุงูุฎูุฑูุฉ ูุงูุงุฌุชูุงุนูุฉ</option>
                            <option value="Retail">ุงูุชุฌุงุฑุฉ ูุงูุชุฌุฒุฆุฉ</option>
                            <option value="Manufacturing">ุงูุตูุงุนุฉ ูุงูุฅูุชุงุฌ</option>
                        </select>
                    </div>
                </div>

                <!-- ุงูุฑุคูุฉ ูุงูุฑุณุงูุฉ ูุงูููู -->
                <div class="space-y-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <h3 class="font-semibold text-gray-700">ุจูุงูุงุช ุงููููุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="vision" class="block text-sm font-medium text-purple-700">ุงูุฑุคูุฉ (ุงููุณุชูุจู)</label>
                            <input type="text" id="vision" placeholder="ูุซุงู: ุฃู ูููู ุงูููุตุฉ ุงูุฑูููุฉ ุงูุฃูุซุฑ ููุซูููุฉ ูู ุงูููุทูุฉ." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border placeholder-gray-400" required>
                        </div>
                        <div>
                            <label for="mission" class="block text-sm font-medium text-blue-700">ุงูุฑุณุงูุฉ (ููุงุฐุง ููุฌุฏุช ุงููุคุณุณุฉ)</label>
                            <input type="text" id="mission" placeholder="ูุซุงู: ุชูููุฑ ุญููู ุชูููุฉ ูุจุชูุฑุฉ ูุชุจุณูุท ุญูุงุฉ ุงููุณุชุฎุฏููู." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border placeholder-gray-400" required>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="values" class="block text-sm font-medium text-pink-700">ุงูููู ุงูุฑุฆูุณูุฉ (ูู ูููุฉ ูู ุณุทุฑ)</label>
                            <textarea id="values" rows="2" placeholder="ูุซุงู:&#10;1. ุงููุฒุงูุฉ&#10;2. ุงูุงุจุชูุงุฑ&#10;3. ุงูุชููุฒ ูู ุงูุฎุฏูุฉ" class="mt-1 block w-full rounded-md shadow-sm p-3 border placeholder-gray-400" required></textarea>
                        </div>
                        <div>
                            <label for="goals" class="block text-sm font-medium text-teal-700">ุงูุฃูุฏุงู ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุนููุง (ุงูุฑุฆูุณูุฉ)</label>
                            <textarea id="goals" rows="2" placeholder="ูุซุงู:&#10;1. ุชุญููู ููู ุณููู 30%&#10;2. ุฏุฎูู ุณูู ุฅููููู ุฌุฏูุฏ&#10;3. ุฑูุน ูุณุชูู ุฑุถุง ุงูุนููุงุก ุฅูู 95%" class="mt-1 block w-full rounded-md shadow-sm p-3 border placeholder-gray-400" required></textarea>
                        </div>
                    </div>
                </div>

                <!-- ูุฏุฎูุงุช SOAR/VRIO ุงูุฅุถุงููุฉ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <div>
                        <label for="aspiration" class="block text-sm font-medium text-purple-700">ุงูุทููุญ ุงูุฑุฆูุณู (SOAR)</label>
                        <input type="text" id="aspiration" placeholder="ูุซุงู: ุฃู ูุตุจุญ ุงูุดุฑูุฉ ุงูุฑุงุฆุฏุฉ ูู ุญููู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุญููู 2028" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border placeholder-gray-400" required>
                    </div>
                    <div>
                        <label for="kpi" class="block text-sm font-medium text-pink-700">ุงููุคุดุฑ ุงูุฑุฆูุณู ูููุชุงุฆุฌ (KPI)</label>
                        <input type="text" id="kpi" placeholder="ูุซุงู: ุชุญููู ููู ูู ุงูุฅูุฑุงุฏุงุช ุจูุณุจุฉ 40% ุณูููุงู" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border placeholder-gray-400" required>
                    </div>
                </div>
                
                <div>
                    <label for="coreResource" class="block text-sm font-medium text-gray-700">ุงูููุฑุฏ ุงูุฏุงุฎูู ุงูุฃุณุงุณู ูุชุญูููู ุจู VRIO (ูุฌุจ ุฃู ูููู ุถูู ููุงุท ุงูููุฉ)</label>
                    <input type="text" id="coreResource" placeholder="ูุซุงู: ุจุฑุงุกุฉ ุงุฎุชุฑุงุน ูุฑูุฏุฉ ููููุชุฌ" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border placeholder-gray-400" required>
                </div>


                <!-- ูุฏุฎูุงุช SWOT ุงูููุณุนุฉ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                        <h3 class="font-semibold text-blue-700">ููุงุท ุงูููุฉ (S) - ุงูููุงุฑุฏ ุงูุฏุงุฎููุฉ</h3>
                        <textarea id="topStrength" rows="4" placeholder="ูุซุงู:&#10;1. ูุฑูู ุนูู ุนุงูู ุงูููุงุกุฉ ูุงูุฎุจุฑุฉ&#10;2. ููุฒุงููุฉ ุชุณููู ุฑููู ูููุฉ&#10;3. ุงูุชูุงู ุจุฑุงุกุฉ ุงุฎุชุฑุงุน ูุฑูุฏุฉ ููููุชุฌ" class="mt-1 block w-full rounded-md shadow-sm p-3 border placeholder-gray-400" required></textarea>
                    </div>
                    
                    <div class="space-y-4 p-4 bg-red-50 rounded-lg border border-red-200">
                        <h3 class="font-semibold text-red-700">ููุงุท ุงูุถุนู (W) - ุงููููุฏ ุงูุฏุงุฎููุฉ</h3>
                        <textarea id="topWeakness" rows="4" placeholder="ูุซุงู:&#10;1. ููุต ุงูุชูููู ุงููุจุฏุฆู ููุงุฑูุฉ ุจุงูููุงูุณูู&#10;2. ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุชูููููุฌูุฉ ูุฏููุฉ ุฌุฒุฆูุงู&#10;3. ุตุนูุจุฉ ูู ุงูุญุตูู ุนูู ุงูุชุฑุงุฎูุต ุงูุญููููุฉ" class="mt-1 block w-full rounded-md shadow-sm p-3 border placeholder-gray-400" required></textarea>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4 p-4 bg-green-50 rounded-lg border border-green-200">
                        <h3 class="font-semibold text-green-700">ุงููุฑุต (O) - ุงูุงุชุฌุงูุงุช ุงูุฎุงุฑุฌูุฉ</h3>
                        <textarea id="topOpportunity" rows="4" placeholder="ูุซุงู:&#10;1. ููู ุณูู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ ุจูุณุจุฉ 20% ุณูููุงู&#10;2. ุชุบูุฑ ูู ุงูููุงุฆุญ ูุตุงูุญ ุงูุงุจุชูุงุฑ&#10;3. ุฅููุงููุฉ ุงูุดุฑุงูุฉ ูุน ููุงูุงุช ุญููููุฉ ูุจุฑู" class="mt-1 block w-full rounded-md shadow-sm p-3 border placeholder-gray-400" required></textarea>
                        
                        <label for="pestelOpportunity" class="block text-sm font-medium text-green-700 mt-2">ูุฑุตุฉ PESTEL (ุงูุฃูุซุฑ ุฃูููุฉ)</label>
                        <input type="text" id="pestelOpportunity" placeholder="ูุซุงู: ููู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ (ุงูุชุตุงุฏู)" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border placeholder-gray-400" required>
                    </div>
                    
                    <div class="space-y-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                        <h3 class="font-semibold text-yellow-700">ุงูุชูุฏูุฏุงุช (T) - ุงููุฎุงุทุฑ ุงูุฎุงุฑุฌูุฉ</h3>
                        <textarea id="topThreat" rows="4" placeholder="ูุซุงู:&#10;1. ุธููุฑ ููุงูุณูู ุฏููููู ุจุฃุณุนุงุฑ ุฃูู&#10;2. ุงุฑุชูุงุน ุชูุงููู ุงูุชุดุบูู ุจุณุจุจ ุงูุชุถุฎู&#10;3. ุชุจุงุทุค ูู ูุนุฏูุงุช ุงูููู ุงูุงูุชุตุงุฏู ุงูุฅููููู" class="mt-1 block w-full rounded-md shadow-sm p-3 border placeholder-gray-400" required></textarea>

                        <label for="pestelThreat" class="block text-sm font-medium text-yellow-700 mt-2">ุชูุฏูุฏ PESTEL (ุงูุฃูุซุฑ ุฃูููุฉ)</label>
                        <input type="text" id="pestelThreat" placeholder="ูุซุงู: ููุงููู ุฎุตูุตูุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ (ูุงูููู)" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border placeholder-gray-400" required>
                    </div>
                </div>
                
                <button type="submit" id="generateBtn" class="w-full bg-teal-600 text-white py-3 rounded-lg font-bold hover:bg-teal-700 transition duration-300 shadow-md">
                    ุชูููุฏ ุงูุชูุฑูุฑ ุงูุงุณุชุฑุงุชูุฌู ุงูุดุงูู
                </button>
            </form>
        </section>

    </main>

    <script>
        let pestelChartInstance = null;
        
        const form = document.getElementById('strategicLabForm');
        const reportSection = document.getElementById('generatedReport');

        const PESTEL_SCORES = {
            'Technology': [3, 4, 3, 5, 2, 4],
            'Charity': [5, 2, 5, 2, 3, 4],
            'Retail': [3, 5, 4, 3, 3, 3],
            'Manufacturing': [4, 4, 3, 3, 5, 4]
        };

        const VRIO_CONCLUSIONS = {
            'high': {
                status: "ููุฒุฉ ุชูุงูุณูุฉ ูุณุชุฏุงูุฉ (VRIO)",
                text: "ุชุญููู VRIO ูุคูุฏ ุฃู ุงูููุฑุฏ ุงููุญุฏุฏ ุฐู ูููุฉุ ููุงุฏุฑุ ููุตุนุจ ุชูููุฏูุ ูุชุฏุนูู ุงููููููุฉ ุงูุชูุธูููุฉ ูููุคุณุณุฉ. ูุฐุง ููุซู ูุตุฏุฑูุง ููููุง ููููุฒุฉ ุงูุชูุงูุณูุฉ ุงููุณุชุฏุงูุฉ ุงูุชู ูุฌุจ ุงูุงุณุชุซูุงุฑ ูููุง ูุญูุงูุชูุง."
            },
            'moderate': {
                status: "ููุฒุฉ ุชูุงูุณูุฉ ูุคูุชุฉ (V_R_I)",
                text: "ุงูููุฑุฏ ุฐู ูููุฉ ููุงุฏุฑ ููุตุนุจ ุชูููุฏูุ ููููู ููุชูุฑ ุฅูู ุงูุชูุธูู ุงููุงูู (O)ุ ุฃู ุฃูู ุณูู ุงูุชูููุฏ (I). ูุฌุจ ุงุชุฎุงุฐ ุฅุฌุฑุงุกุงุช ููุฑูุฉ ูุชุนุฒูุฒ ุงููููู ุงูุชูุธููู ุฃู ุฒูุงุฏุฉ ุญูุงูุฉ ุงูููุฑุฏ ูุถูุงู ุงุณุชูุฑุงุฑ ุงูููุฒุฉ."
            },
            'low': {
                status: "ุชูุงูุค ุชูุงูุณู / ุนูุจ ุชูุงูุณู",
                text: "ุงูููุฑุฏ ูุง ูููุญ ุงููุคุณุณุฉ ููุฒุฉ ูุงุถุญุฉ ุนูู ุงููุฏู ุงูุทูููุ ุฅูุง ูุณูููุฉ ุงูุญุตูู ุนููู ูู ูุจู ุงูููุงูุณูู (ุชูุงูุค)ุ ุฃู ุฃูู ููุซู ููุทุฉ ุถุนู. ููุตู ุจุฅุนุงุฏุฉ ุชูููู ูุฐุง ุงูููุฑุฏ ูุชูุฌูู ุงูุงุณุชุซูุงุฑ ูุญู ููุงุฑุฏ ุฐุงุช ุฎุตุงุฆุต VRIO ุฃุนูู."
            }
        };

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            generateStrategicReport();
        });

        function getIndustryText(industryValue) {
            const industryMap = {
                'Technology': 'ุงูุชูููุฉ ูุงูุงุจุชูุงุฑ',
                'Charity': 'ุงูุฌูุนูุงุช ุงูุฎูุฑูุฉ ูุงูุงุฌุชูุงุนูุฉ',
                'Retail': 'ุงูุชุฌุงุฑุฉ ูุงูุชุฌุฒุฆุฉ',
                'Manufacturing': 'ุงูุตูุงุนุฉ ูุงูุฅูุชุงุฌ'
            };
            return industryMap[industryValue] || industryValue;
        }

        function processTextarea(textareaId) {
            const text = document.getElementById(textareaId).value;
            return text.split('\n').map(line => line.trim()).filter(line => line.length > 0).map(item => item.replace(/^[0-9]\.\s*/, '')); // Remove leading list numbers
        }

        function generateStrategicReport() {
            const name = document.getElementById('entityName').value;
            const industryValue = document.getElementById('entityIndustry').value;
            const industryText = getIndustryText(industryValue);
            
            // Core Identity Data
            const Vision = document.getElementById('vision').value;
            const Mission = document.getElementById('mission').value;
            const Values = processTextarea('values').join(' | ');
            const Goals = processTextarea('goals').join(' | ');

            // SOAR/VRIO Data
            const Aspiration = document.getElementById('aspiration').value; 
            const KPI = document.getElementById('kpi').value;
            const CoreResource = document.getElementById('coreResource').value;
            
            // SWOT Data
            const S_List = processTextarea('topStrength');
            const W_List = processTextarea('topWeakness');
            const O_List = processTextarea('topOpportunity');
            const T_List = processTextarea('topThreat');
            const PESTEL_O = document.getElementById('pestelOpportunity').value;
            const PESTEL_T = document.getElementById('pestelThreat').value;
            
            if (S_List.length < 1 || W_List.length < 1 || O_List.length < 1 || T_List.length < 1 || !Vision || !Mission) {
                console.error("ุงูุฑุฌุงุก ุฅููุงู ุฌููุน ุงูุญููู ุงููุทููุจุฉ (ุจูุง ูู ุฐูู ุงูุฑุคูุฉ ูุงูุฑุณุงูุฉ).");
                return;
            }

            // Update Report Header & Identity
            document.getElementById('reportEntityName').textContent = `ุงูุชูุฑูุฑ ุงูุงุณุชุฑุงุชูุฌู ูู: ${name}`;
            document.getElementById('reportDate').textContent = `ุชุงุฑูุฎ ุงูุชูุฑูุฑ: ${new Date().toLocaleDateString('ar-EG', { year: 'numeric', month: 'long', day: 'numeric' })}`;
            document.getElementById('r_industry').textContent = industryText;

            document.getElementById('r_vision').textContent = Vision;
            document.getElementById('r_mission').textContent = Mission;
            document.getElementById('r_values').textContent = Values;
            document.getElementById('r_goals').textContent = Goals;


            // 1. SWOT Results (Populate lists)
            document.getElementById('r_strength').innerHTML = S_List.map(item => `<li>${item}</li>`).join('');
            document.getElementById('r_weakness').innerHTML = W_List.map(item => `<li>${item}</li>`).join('');
            document.getElementById('r_opportunity').innerHTML = O_List.map(item => `<li>${item}</li>`).join('');
            document.getElementById('r_threat').innerHTML = T_List.map(item => `<li>${item}</li>`).join('');

            // 2. TOWS Results (Richer, based on focus items and general list)
            document.getElementById('r_so').textContent = `ุงุณุชุฑุงุชูุฌูุฉ ุงูููู (SO): ุจุงุณุชุฎุฏุงู ุงูููุฉ ( ${CoreResource} )ุ ูุฌุจ ุงุณุชุบูุงู ุงููุฑุตุฉ ุงูุฑุฆูุณูุฉ ( ${PESTEL_O} ) ูุชุญููู ุงููุฏู ุงูุฃูู: ${Goals.split(' | ')[0]}.`;
            document.getElementById('r_wo').textContent = `ุงุณุชุฑุงุชูุฌูุฉ ุงููุนุงูุฌุฉ (WO): ูุฌุจ ุงุณุชุซูุงุฑ ุงููุฑุตุฉ ( ${PESTEL_O} ) ููุนุงูุฌุฉ ุงูุถุนู ุงูุญุฑุฌ ( ${W_List[0]} ). ูุฐุง ุงูุนูุงุฌ ูุฏุนู ุงูุฑุณุงูุฉ: ${Mission}.`;
            document.getElementById('r_st').textContent = `ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุญุตูู (ST): ุงุณุชุฎุฏุงู ุงูููุฉ ุงูุฏุงุฎููุฉ ( ${CoreResource} ) ูุฏุฑุน ุถุฏ ุงูุชูุฏูุฏ ุงูุฃูุซุฑ ุฃูููุฉ ( ${PESTEL_T} ). ูุฐุง ุงูุฅุฌุฑุงุก ูุญูู ุงููููุฉ ุงูุฃุณุงุณูุฉ: ${Values.split(' | ')[0]}.`;
            document.getElementById('r_wt').textContent = `ุงุณุชุฑุงุชูุฌูุฉ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ (WT): ูุชุฌูุจ ุงูุณููุงุฑูู ุงูุฃุณูุฃ ุงููุงุชุฌ ุนู ุงุฌุชูุงุน ุงูุถุนู ( ${W_List[0]} ) ูุน ุงูุชูุฏูุฏ ( ${PESTEL_T} )ุ ูุฌุจ ุชูุนูู ุฎุทุฉ ุทูุงุฑุฆ ุนุงุฌูุฉ.`;

            // 3. SOAR Results
            document.getElementById('r_aspiration_text').textContent = Aspiration;
            document.getElementById('r_soar_strength').textContent = CoreResource;
            document.getElementById('r_soar_kpi').textContent = KPI;
            document.getElementById('r_soar_vision').textContent = Vision;


            // 4. VRIO Results (Simulated)
            document.getElementById('vrio_resource').textContent = CoreResource;
            document.getElementById('r_vrio_values').textContent = Values;
            
            let vrioResultKey = 'moderate'; 
            
            if (CoreResource.includes('ุจุฑุงุกุฉ ุงุฎุชุฑุงุน') || CoreResource.includes('ููููุฉ ููุฑูุฉ') || CoreResource.includes('ุฃุตูู ูุงุฏุฑุฉ')) {
                vrioResultKey = 'high'; 
            } else if (CoreResource.includes('ุณุนุฑ') || CoreResource.includes('ููุฒุงููุฉ') || W_List.some(w => w.includes('ุชูุธูู')) || !Vision) {
                 vrioResultKey = 'moderate'; 
            } else if (W_List.length > 3) {
                vrioResultKey = 'low';
            }

            const vrioResult = VRIO_CONCLUSIONS[vrioResultKey];
            document.getElementById('r_vrio_conclusion').textContent = `${vrioResult.status}: ${vrioResult.text}`;
            document.getElementById('r_vrio_conclusion').className = vrioResult.status.includes('ูุณุชุฏุงูุฉ') ? 
                "p-4 rounded-lg font-semibold bg-green-50 text-green-800 border border-green-300" : 
                vrioResult.status.includes('ูุคูุชุฉ') ?
                "p-4 rounded-lg font-semibold bg-yellow-50 text-yellow-800 border border-yellow-300" :
                "p-4 rounded-lg font-semibold bg-red-50 text-red-800 border border-red-300";


            // 5. PESTEL Chart Generation
            const data = PESTEL_SCORES[industryValue] || PESTEL_SCORES.Technology;
            renderPestelChart(data);

            // Show Report
            reportSection.classList.remove('hidden');
            reportSection.scrollIntoView({ behavior: 'smooth' });
        }
        
        function renderPestelChart(data) {
            const ctx = document.getElementById('reportPestelChart');
            
            if (pestelChartInstance) {
                pestelChartInstance.destroy();
            }

            const pestelData = {
                labels: [
                    'ุงูุณูุงุณูุฉ (P)', 'ุงูุงูุชุตุงุฏูุฉ (E)', 'ุงูุงุฌุชูุงุนูุฉ (S)', 'ุงูุชูููููุฌูุฉ (T)', 'ุงูุจูุฆูุฉ (E)', 'ุงููุงููููุฉ (L)'
                ],
                datasets: [{
                    label: 'ูุฏู ุงูุชุฃุซูุฑ (ูู 1 ุฅูู 5)',
                    data: data, 
                    fill: true,
                    backgroundColor: 'rgba(15, 118, 118, 0.3)',
                    borderColor: 'rgb(15, 118, 118)',
                    pointBackgroundColor: 'rgb(15, 118, 118)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgb(15, 118, 118)'
                }]
            };

            pestelChartInstance = new Chart(ctx.getContext('2d'), {
                type: 'radar',
                data: pestelData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: { family: "'Cairo', sans-serif" }
                            }
                        },
                        tooltip: {
                            titleFont: { family: "'Cairo', sans-serif" },
                            bodyFont: { family: "'Cairo', sans-serif" }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            min: 0,
                            max: 5,
                            stepSize: 1,
                            ticks: {
                                backdropColor: 'rgba(249, 250, 251, 0.7)' 
                            },
                            pointLabels: {
                                font: {
                                    family: "'Cairo', sans-serif",
                                    size: 13,
                                    weight: 'bold'
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Initial setup on DOMContentLoaded: Clear placeholders after initial generation
        document.addEventListener('DOMContentLoaded', () => {
             // Default values for initial demonstration
            document.getElementById('entityName').value = 'ุดุฑูุฉ ุงููุณุชูุจู ุงูุฑููู';
            document.getElementById('vision').value = 'ุฃู ูููู ุงูููุตุฉ ุงูุฑูููุฉ ุงูุฃูุซุฑ ููุซูููุฉ ูู ุงูููุทูุฉ.';
            document.getElementById('mission').value = 'ุชูููุฑ ุญููู ุชูููุฉ ูุจุชูุฑุฉ ูุชุจุณูุท ุญูุงุฉ ุงููุณุชุฎุฏููู.';
            document.getElementById('values').value = "ุงููุฒุงูุฉ\nุงูุงุจุชูุงุฑ\nุงูุชููุฒ ูู ุงูุฎุฏูุฉ";
            document.getElementById('goals').value = "ุชุญููู ููู ุณููู 30%\nุฏุฎูู ุณูู ุฅููููู ุฌุฏูุฏ\nุฑูุน ูุณุชูู ุฑุถุง ุงูุนููุงุก ุฅูู 95%";
            document.getElementById('aspiration').value = 'ุฃู ูุตุจุญ ุงูุดุฑูุฉ ุงูุฑุงุฆุฏุฉ ูู ุญููู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุญููู 2028';
            document.getElementById('kpi').value = 'ุชุญููู ููู ูู ุงูุฅูุฑุงุฏุงุช ุจูุณุจุฉ 40% ุณูููุงู';
            document.getElementById('coreResource').value = 'ุจุฑุงุกุฉ ุงุฎุชุฑุงุน ูุฑูุฏุฉ ููููุชุฌ';
            document.getElementById('topStrength').value = "ูุฑูู ุนูู ุนุงูู ุงูููุงุกุฉ ูุงูุฎุจุฑุฉ\nููุฒุงููุฉ ุชุณููู ุฑููู ูููุฉ\nุงูุชูุงู ุจุฑุงุกุฉ ุงุฎุชุฑุงุน ูุฑูุฏุฉ ููููุชุฌ";
            document.getElementById('topWeakness').value = "ููุต ุงูุชูููู ุงููุจุฏุฆู ููุงุฑูุฉ ุจุงูููุงูุณูู\nุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุชูููููุฌูุฉ ูุฏููุฉ ุฌุฒุฆูุงู\nุตุนูุจุฉ ูู ุงูุญุตูู ุนูู ุงูุชุฑุงุฎูุต ุงูุญููููุฉ";
            document.getElementById('topOpportunity').value = "ููู ุณูู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ ุจูุณุจุฉ 20% ุณูููุงู\nุชุบูุฑ ูู ุงูููุงุฆุญ ูุตุงูุญ ุงูุงุจุชูุงุฑ\nุฅููุงููุฉ ุงูุดุฑุงูุฉ ูุน ููุงูุงุช ุญููููุฉ ูุจุฑู";
            document.getElementById('topThreat').value = "ุธููุฑ ููุงูุณูู ุฏููููู ุจุฃุณุนุงุฑ ุฃูู\nุงุฑุชูุงุน ุชูุงููู ุงูุชุดุบูู ุจุณุจุจ ุงูุชุถุฎู\nุชุจุงุทุค ูู ูุนุฏูุงุช ุงูููู ุงูุงูุชุตุงุฏู ุงูุฅููููู";
            document.getElementById('pestelOpportunity').value = 'ููู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ (ุงูุชุตุงุฏู)';
            document.getElementById('pestelThreat').value = 'ููุงููู ุฎุตูุตูุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ (ูุงูููู)';

            // Generate initial report
            generateStrategicReport(); 
            reportSection.classList.add('hidden'); // Then hide it, awaiting user interaction
            
            // Clear input fields after initial generation to show placeholders
            document.getElementById('entityName').value = '';
            document.getElementById('vision').value = '';
            document.getElementById('mission').value = '';
            document.getElementById('values').value = '';
            document.getElementById('goals').value = '';
            document.getElementById('aspiration').value = '';
            document.getElementById('kpi').value = '';
            document.getElementById('coreResource').value = '';
            document.getElementById('topStrength').value = '';
            document.getElementById('topWeakness').value = '';
            document.getElementById('topOpportunity').value = '';
            document.getElementById('topThreat').value = '';
            document.getElementById('pestelOpportunity').value = '';
            document.getElementById('pestelThreat').value = '';
        });
    </script>

</body>
</html>
